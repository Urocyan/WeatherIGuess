<head>	
	<title>Open Weather</title>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="https://code.jquery.com/jquery-1.10.2.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.4/angular.min.js"></script>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script>
$(document).ready(function () {
	var gotCoords = false;
	var latitude = null;
	var longitude = null;
	var getLoc = function() {
		if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(showPosition);
		gotCoords = true;
		} else { 
        gotCoords = false;
		}
	}
	var showPosition = function(position) {
		latitude = position.coords.latitude;
		latitude = latitude.toPrecision(5);
		longitude = position.coords.longitude;
		longitude = longitude.toPrecision(5);
	}
	
	var getWeather = function() {
		if((latitude != null && longitude != null)&& $("#zipInput").val() == "") {
			var openWeather = "http://api.openweathermap.org/data/2.5/weather?&APPID=4f1467625e222a3345ce0a44f13333e7&lat="+latitude+"&lon="+longitude;
			console.log(openWeather);
		}
		else {
			var curZip = $("#zipInput").val();
			if(curZip.length != 5 || isNaN(curZip)) {
			$("#alertBox").removeClass("alert-success");
			$("#alertBox").addClass("alert-warning");
			}
			else {
			$("#alertBox").addClass("alert-success");
			$("#alertBox").removeClass("alert-warning");
			var openWeather = "http://api.openweathermap.org/data/2.5/weather?&APPID=4f1467625e222a3345ce0a44f13333e7&zip="+curZip;
			}
		}
		$.ajax({
			type: "GET",
			dataType: "json",
			url: openWeather,
			success: function( data ) {
			var curTemp = (data.main.temp * (9/5)) - 459.67;
			curTemp = curTemp.toPrecision(4);
			var curHum = data.main.humidity + "%";
			var location = data.name;
			$("#loc").text( location );
			$("#temp").text( curTemp + " F");
			$("#hum").text( curHum );
			if(curTemp < 60) {
				$("#mainPage").css("background-color", "turquoise");
				$("#mainPage").css("color", "white");
			}
			else if(curTemp >= 60 && curTemp <= 90) {
				$("#mainPage").css("background-color", "orange");
				$("#mainPage").css("color", "white");
			}
			else if(curTemp > 90) {
				$("#mainPage").css("background-color", "red");
				$("#mainPage").css("color", "white");
			}
		}
	});
	}
	$("#geolocButton").click(function() {
		getLoc();
	});
	$("#getWeatherButton").click( function() {
		getWeather();
	});
});
</script>
<style>
body {
	font-size: 36pt;
	text-color: black;
	font-family: Helvetica;
	transition: background-color 2s ease, color 2s ease;
}
</style>
</head>
<body id="mainPage">
<div class="row">
	<div class="col-lg-12" ng-app="">
		<div class="input-group">
			<span class="input-group-addon">Zip Code</span>
			<input id="zipInput" type="text" class="form-control" name="msg" placeholder="Enter Zip Code Here" ng-model="name" style="display: block;">
			<div class="input-group-btn">
				<button class="btn btn-info" style="height:100%;" id="geolocButton">Detect Location <span class="glyphicon glyphicon-screenshot"></span></button>
			</div>
			<div class="input-group-btn">
				<button class="btn btn-primary" id="getWeatherButton">Get Weather <span class="glyphicon glyphicon-refresh"></span></button>
			</div>
		</div>
		<p id="alertBox" ng-bind="name" class="alert alert-success"></p>
	</div>
</div>
<div class="row">
	<div class="col-lg-4">
		<p>Location: <span id="loc"></span></p>
	</div>
	<div class="col-lg-8">
		<p>Current Temperature: <span id="temp"></span></p>
	</div>
	<div class="col-lg-4">
		<p>Humidity: <span id="hum"></span></p>
	</div>
</div>
</body>
</html>